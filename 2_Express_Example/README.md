## 웹서버

### 간단한 웹 서버 만들기

웹 서버는 일반적으로 웹 브라우저라고 하는 크라이언트에서 HTTP 프로토콜로 요청한 정보를 처리한 후 응답을 보내 주는 역할을 한다. 만약 웹 브라우저가 웹 서버에 접속한 후 데이터를 요청하면 그때마다 적절한 이벤트가 발생하므로 다양한 상황에 맞추어 콜백 함수를 각각 등록한다.  

#### GET 방식과 POST 방식의 차이점<hr>

> 웹 서버에 요청을 보내는 방식은 GET, POST, PUT, DELETE 등 여러 가지가 있다. 인터넷 표준으로 정해 둔 이러한 요청 방식을 메소드라고도 부른다. HTTP 요청 포맷을 보면 크게 헤더(Header)와 본문(Body) 부분으로 나뉘는데 GET 방식은 헤더 부분에 요청 정보들을 넣어 보내고 POST 방식은 본문 부분에 요청 정보를 넣어 보낸다. 이 두 가지 방식은 기능상으로는 요청 정보를 보낸다는 점에서 같지만 보안 등의 이슈가 있을 때나 파일을 요청 정보로 넣어 보내야 하는 경우(파일 업로드)에는 POST 방식을 주로 사용한다.


### 5-2 익스프레스로 웹 서버 만들기
 
http 모듈만 사용해서 웹 서버를 구성할 때는 많은 것들을 직접 만들어야한다. 하지만 직접 만들어야하는 코드가 많다면 시간과 노력이 많이 든다는 문제가 발생한다. 이 문제를 해경할기 위해 만들어진 것이 익스프레스(Express)이다.

이 익스프레서 서버 객체가 가지고 있는 주요 메소드들은 다음과 같다.  

|<center>Header1</center> |  <center>Header2</center> 
|:--------|:--------:|
|set(name, value) |서버 설정을 위한 속성을 지정한다. set() 메소드로 지정한 속성은 get() 메소드로 꺼내어 확인할 수 있다.|
|get(name) |서버 설정을 위해 지정한 속성을 꺼내 온다.|
|use([path,] function[,function])| 미들웨어 함수를 사용한다.|
|get([path,] function)| 특정 패스로 요청된 정보를 처리한다.|

### 5.3 미들웨어
익스프레스에서는 미들웨어 이외에 라우터도 사용하는데 미들웨어나 라우터는 하나의 독립된 기능을 가진 함수라고 생각할 수 있다. 다시 말새, 익스프레스에서는 웹 요청과 응답에 관한 정보를 사용해 필요한 처리를 진행할 수 있도록 독깁된 함수로 분리한다. 이렇게 분리한 각각의 것들을 <b>미들웨어</b>라고 부른다.  
라우터는 클라이언트의 요청 패스를 보고 이 요청 정보를 처리할 수 있는 곳으로 기능을 전달해 주는 역할을 한다. 이러한 역할을 흔히 <b>라우팅(Routing)</b>이라고 부르는데, 클라이언트의 요청 패스에 따라 각각을 담당하는 함수로 분리시키는 것이다.

### 5.4 라우팅
단순히 use() 메소드를 사용하면 use() 메소드로 설정한 모든 미들웨어 함수가 항상 호출되기 때문에 문제가 발생한다. 따라서 사용자 요청한 기능에 따른 미들웨어를 실행하기 위해 <b>라우터 미들웨어(router middleware)</b>를 사용한다.

#### URL 파라미터 사용

<pre>
let router = express.Router();
router.route('/process/login/:name).post(fuction(req,res){...});
</pre>

이것은 /process/login/ 뒤에 오는 값을 파라미터로 처리하겠다는 의미이다. 이렇게 지정한 파라미터는 req.params.name 속성으로 접근할 수 있다. 이것을 <b>토큰(Token)</b>이라고 부른다.  
html 파일에서 action 속성을 /process/login/mike를 넣게 되면 mike라는 문자열이 URL 파라미터로 전달된다.

### 5.4 쿠키와 세션

사용자가 로그인한 상태인지 아닌지 확인하고 싶을 때에는 쿠키나 세션을 사용한다. 쿠키는 클라이언트 웹 브라우저에 저장되는 정보이며, 세션 웹 서버에 저장되는 정보이다.

#### 쿠키
쿠키는 클라이언트 웹 브라우저에 저장되는 정보로서 일정 기간 동안 저장하고 싶을 떄 사용한다. 익스프레스에서는 cookie-parser 미들웨어를 사용하면 쿠키를 설정하거나 확인 할 수 있다.

### 세션
세션은 서버 쪽에 상태 정보를 저장한다. 세션을 사용하는 대표적인 예로는 로그인을 했을 때 저장되는 세션을 들 수 있다.

사용자가 로그인하면 세션이 만들어지고 로그아웃하면 세션이 삭제되는 기능을 만들면 사용자가 로그인하기 전에는 접근이 제한된 페이지를 보지 못하도록 설정할수 있다. 즉, 사용자가 상품 페이지처럼 접근이 제한된 페이지를 조회했을 때 로그인된 상태가 아니라면 로그인 페이지를 자동으로 열어 준다. 그러면 로그인 해야 상품 페이지로 이동할 수 있으며 상품 페이지에서 로그아웃할 수 있다.
